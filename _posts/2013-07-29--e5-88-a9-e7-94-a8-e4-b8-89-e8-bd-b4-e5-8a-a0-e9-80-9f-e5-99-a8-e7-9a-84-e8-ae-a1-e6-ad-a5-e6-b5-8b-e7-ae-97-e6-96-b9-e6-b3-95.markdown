---
layout: post
title: 利用三轴加速器的计步测算方法
date: 2013-07-29 17:20:37.000000000 +08:00
---

<div>随着现代生活质量提高，越来越多人开始注重自己的日常健康锻炼，计步作为一种有效记录监控锻炼的监控手段，已经广泛应用在移动终端的应用中。但目前大部分实现都是通过GPS信号来测算运动距离反推行走步数，有效但是在室内或者无GPS信号的设备上无法工作，同时GPS精度对结果的干扰也比较大，本文提出一个新的测步方法，即通过设备上的加速器来计算步数，在不支持GPS的设备上也可正常工作，可用以与GPS互相配合测步，让应用的使用场景更加多样。

**1. 了解模型特征**

目前大部分设备都提供了可以检测各个方向的加速检测器，以iOS设备为例，我们利用了其三轴加速计（x,y,z轴代表方向如图）的特性来分析。分别用以检测人步行中三个方向的加速度变化。  [![iphone](http://alibuybuy-img11.stor.sinaapp.com/2013/07/65e0_iphone.jpeg)](http://alibuybuy-img11.stor.sinaapp.com/2013/07/65e0_iphone.jpeg)

用户在水平步行运动中，垂直和前进两个加速度会呈现周期性变化，如图所示，在步行收脚的动作中，由于重心向上单只脚触地，垂直方向加速度是呈正向增加的趋势，之后继续向前，重心下移两脚触底，加速度相反。水平加速度在收脚时减小，在迈步时增加。

[![1](http://alibuybuy-img11.stor.sinaapp.com/2013/07/5d9f_110.jpg)](http://alibuybuy-img11.stor.sinaapp.com/2013/07/5d9f_110.jpg)

反映到图表中，我们可以看到在步行运动中，垂直和前进产生的加速度与时间大致为一个正弦曲线，而且在某点有一个峰值，其中垂直方向的加速度变化最大，通过对轨迹的峰值进行检测计算和加速度阈值决策，即可实时计算用户运动的步数，还可依此进一步估算用户步行距离。

[![2](http://alibuybuy-img11.stor.sinaapp.com/2013/07/0df5_2.gif)](http://alibuybuy-img11.stor.sinaapp.com/2013/07/0df5_2.gif)

 

**2.  计步算法**

因为用户在运动中可能手平持设备或者将设备置于口袋中，所以设备的放置方向不定，为此我们通过计算三个加速度的矢量长度，获得一条步行运动的正弦曲线轨迹。

第二步是峰值检测，我们记录了上次矢量长度和运动方向，通过矢量长度的变化，可以判断目前加速度的方向，并和上一次保存的加速度方向进行比较，如果是相反的，即是刚过峰值状态，则进入计步逻辑进行计步，否则舍弃。通过对峰值的次数累加可得到用户步行步伐。

最后是去干扰，手持设备会有一些低幅度和快速的抽动状态，或是我们俗称的手抖，或者某个恶作剧用户想通过短时快速反复摇动设备来模拟人走路，这些干扰数据如果不剔除，会影响记步的准确值，对于这种干扰，我们可以通过给检测加上阈值和步频判断来过滤。

[![3](http://alibuybuy-img11.stor.sinaapp.com/2013/07/07e7_32.jpg)](http://alibuybuy-img11.stor.sinaapp.com/2013/07/07e7_32.jpg)

 

人体最快的跑步频率为5HZ，也就是说相邻两步的时间间隔的至少大于0.2秒，如图所示，我们设置了timespan在记步过程中我们过滤了高频噪声，即步频过快的情况。同时我们通过和上次加速度大小进行比较，设置设立一定的阈值Threshold来判断运动是否属于有效，有效运动才可进行记步。

 

**3. 关于计步器的扩展**

以上是一个依靠加速度测算的计步器实现原理，已知步行和跑步的步伐经验值，那么稍微改进下即可变成一个测距测速计。

通过三轴加速度我们可以知道用户的运动状态，除了计步，我们还可以通过加速器的变化曲线判断用户摔倒状态，做成一个老人和儿童摔倒检测自动报警器。

</div><div>- (本文出自Tencent CDC Blog，转载时请注明出处)

</div> 

- - - - - -

<small>© 推荐 for [互联网的那点事](http://www.alibuybuy.com/). |  
 猛击下载：[**iPhone客户端**](https://itunes.apple.com/cn/app/hu-lian-wang-de-na-dian-shi/id670210055?mt=8) 猛击下载：[**Android客户端**](http://www.alibuybuy.com/alibuybuy.apk)  
</small>

未经允许不得转载：[空洽网](http://kongqia.com) » [利用三轴加速器的计步测算方法](http://kongqia.com/16988.html)


