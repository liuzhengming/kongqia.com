<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    

    

    

    
    <title>Javascript面向对象编程（三）：非构造函数的继承</title>
    <meta name="description" content="人生不是要过的怎样，而是要懂得怎样去过。" />

    
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="shortcut icon" href="/assets/favicon.ico">

    
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />


    
    
</head>
<body class="post-template nav-closed">

    
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
            <li class="nav-" role="presentation"><a href="/">首页</a></li>
        
            <li class="nav-" role="presentation"><a href="/aboutme">关于我</a></li>
        
    </ul>
    
        <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>



    <div class="site-wrapper">

        
        <header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">
    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Javascript面向对象编程（三）：非构造函数的继承</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-08-24">24 August 2016</time> 
            </section>
        </header>

        <section class="post-content">
            <p>这个系列的<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_encapsulation.html">第一部分</a>介绍了”封装”，<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance.html">第二部分</a>介绍了使用构造函数实现”继承”。</p>

<p>今天是最后一个部分，介绍不使用构造函数实现”继承”。</p>

<p>一、什么是”非构造函数”的继承？</p>

<p>比如，现在有一个对象，叫做”中国人”。</p>

<blockquote>
  <p>var Chinese = {<br />
 nation:’中国’<br />
 };</p>
</blockquote>

<p>还有一个对象，叫做”医生”。</p>

<blockquote>
  <p>var Doctor ={<br />
 career:’医生’<br />
 }</p>
</blockquote>

<p>请问怎样才能让”医生”去继承”中国人”，也就是说，我怎样才能生成一个”中国医生”的对象？</p>

<p>这里要注意，这两个对象都是普通对象，不是构造函数，无法使用构造函数方法实现”继承”。</p>

<p>二、object()方法</p>

<p>json格式的发明人Douglas Crockford，提出了一个object()函数，可以做到这一点。</p>

<blockquote>
  <p>function object(o) {</p>

  <p>function F() {}</p>

  <p>F.prototype = o;</p>

  <p>return new F();</p>

  <p>}</p>
</blockquote>

<p>这个object()函数，其实只做一件事，就是把子对象的prototype属性，指向父对象，从而使得子对象与父对象连在一起。</p>

<p>使用的时候，第一步先在父对象的基础上，生成子对象：</p>

<blockquote>
  <p>　　var Doctor = object(Chinese);</p>
</blockquote>

<p>然后，再加上子对象本身的属性：</p>

<blockquote>
  <p>　　Doctor.career = ‘医生’;</p>
</blockquote>

<p>这时，子对象已经继承了父对象的属性了。</p>

<blockquote>
  <p>　　alert(Doctor.nation); //中国</p>
</blockquote>

<p>三、浅拷贝</p>

<p>除了使用”prototype链”以外，还有另一种思路：把父对象的属性，全部拷贝给子对象，也能实现继承。</p>

<p>下面这个函数，就是在做拷贝：</p>

<blockquote>
  <p>　　function extendCopy(p) {</p>

  <p>var c = {};</p>

  <p>for (var i in p) {<br />
 c[i] = p[i];<br />
 }</p>

  <p>c.uber = p;</p>

  <p>return c;<br />
 }</p>
</blockquote>

<p>使用的时候，这样写：</p>

<blockquote>
  <p>　　var Doctor = extendCopy(Chinese);</p>

  <p>Doctor.career = ‘医生’;</p>

  <p>alert(Doctor.nation); // 中国</p>
</blockquote>

<p>但是，这样的拷贝有一个问题。那就是，如果父对象的属性等于数组或另一个对象，那么实际上，子对象获得的只是一个内存地址，而不是真正拷贝，因此存在父对象被篡改的可能。</p>

<p>请看，现在给Chinese添加一个”出生地”属性，它的值是一个数组。</p>

<blockquote>
  <p>　　Chinese.birthPlaces = [‘北京’,’上海’,’香港’];</p>
</blockquote>

<p>通过extendCopy()函数，Doctor继承了Chinese。</p>

<blockquote>
  <p>　　var Doctor = extendCopy(Chinese);</p>
</blockquote>

<p>然后，我们为Doctor的”出生地”添加一个城市：</p>

<blockquote>
  <p>　　Doctor.birthPlaces.push(‘厦门’);</p>
</blockquote>

<p>发生了什么事？Chinese的”出生地”也被改掉了！</p>

<blockquote>
  <p>　　alert(Doctor.birthPlaces); //北京, 上海, 香港, 厦门</p>

  <p>alert(Chinese.birthPlaces); //北京, 上海, 香港, 厦门</p>
</blockquote>

<p>所以，extendCopy()只是拷贝基本类型的数据，我们把这种拷贝叫做”浅拷贝”。这是早期jQuery实现继承的方式。</p>

<p>四、深拷贝</p>

<p>所谓”深拷贝”，就是能够实现真正意义上的数组和对象的拷贝。它的实现并不难，只要递归调用”浅拷贝”就行了。</p>

<blockquote>
  <p>　　function deepCopy(p, c) {</p>

  <table>
    <tbody>
      <tr>
        <td>var c = c</td>
        <td> </td>
        <td>{};</td>
      </tr>
    </tbody>
  </table>

  <p>for (var i in p) {</p>

  <p>if (typeof p[i] === ‘object’) {</p>

  <p>c[i] = (p[i].constructor === Array) ? [] : {};</p>

  <p>deepCopy(p[i], c[i]);</p>

  <p>} else {</p>

  <p>c[i] = p[i];</p>

  <p>}<br />
 }</p>

  <p>return c;<br />
 }</p>
</blockquote>

<p>使用的时候这样写：</p>

<blockquote>
  <p>　　var Doctor = deepCopy(Chinese);</p>
</blockquote>

<p>现在，给父对象加一个属性，值为数组。然后，在子对象上修改这个属性：</p>

<blockquote>
  <p>　　Chinese.birthPlaces = [‘北京’,’上海’,’香港’];</p>

  <p>Doctor.birthPlaces.push(‘厦门’);</p>
</blockquote>

<p>这时，父对象就不会受到影响了。</p>

<blockquote>
  <p>　　alert(Doctor.birthPlaces); //北京, 上海, 香港, 厦门</p>

  <p>alert(Chinese.birthPlaces); //北京, 上海, 香港</p>
</blockquote>

<p>目前，jQuery库使用的就是这种继承方法。</p>

<p>转至：http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance_continued.html</p>

<p>未经允许不得转载：<a href="http://kongqia.com">空洽网</a> » <a href="http://kongqia.com/33729.html">Javascript面向对象编程（三）：非构造函数的继承</a></p>


        </section>

        <footer class="post-footer">

        
        
        
        

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Javascript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B(%E4%B8%89):%E9%9D%9E%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E7%BB%A7%E6%89%BF&amp;url=/2016/08/24/javascript-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e7-bc-96-e7-a8-8b-ef-bc-88-e4-b8-89-ef-bc-89-ef-bc-9a-e9-9d-9e-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0-e7-9.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2016/08/24/javascript-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e7-bc-96-e7-a8-8b-ef-bc-88-e4-b8-89-ef-bc-89-ef-bc-9a-e9-9d-9e-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0-e7-9.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2016/08/24/javascript-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e7-bc-96-e7-a8-8b-ef-bc-88-e4-b8-89-ef-bc-89-ef-bc-9a-e9-9d-9e-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0-e7-9.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            
            

        </footer>

    </article>
</main>


<aside class="read-next">
    
    <a class="read-next-story no-cover" href="/2016/08/24/e5-88-9d-e5-ad-a6-e8-80-85-e5-bf-85-e9-a1-bb-e6-8e-8c-e6-8f-a1-e7-9a-84angularjs-e6-8a-80-e6-9c-af-e8-a6-81-e7-82-b9-e6-b8-85-e5-8d-95.html">
        <section class="post">
            <h2>初学者必须掌握的AngularJS技术要点清单</h2>
            <p>这篇文章的主要目标是帮助初学者了解在学习AngularJS过程中，哪些东西是非常重要的，哪些东西学习的优先级较低。


&hellip;</p>
        </section>
    </a>
    
    
    <a class="read-next-story prev no-cover" href="/2016/08/24/javascript-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e7-bc-96-e7-a8-8b-ef-bc-88-e4-ba-8c-ef-bc-89-ef-bc-9a-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0-e7-9a-84-e7-b.html">
        <section class="post">
            <h2>Javascript面向对象编程（二）：构造函数的继承</h2>
            <p>这个系列的第一部分，主要介绍了如何”封装”数据和方法，以及如何从原型对象生成实例。

&hellip;</p>
        </section>
    </a>
    
</aside>


        
        <footer class="site-footer clearfix">
            <section class="copyright"><a href=""></a> &copy; 2020</section>
            <section class="poweredby">Casper theme by <a href="https://ghost.org">Ghost</a>, adopted to Jekyll by <a href="https://github.com/Jinmo/jekyll-casper">Jinmo</a></section>
        </footer>

    </div>

    
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    
    
    
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
